# Issue #06: ãƒªãƒ¼ã‚°ç®¡ç†APIå®Ÿè£…

## ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹
ğŸ”´ **Open**

## å„ªå…ˆåº¦
ğŸ”¥ **High**

## æ¦‚è¦

ãƒªãƒ¼ã‚°ç®¡ç†ãƒ»ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ç®¡ç†APIã‚’å®Ÿè£…ã™ã‚‹ã€‚Hono RPC + 3å±¤ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã§å‹å®‰å…¨ãªAPIã‚’æ§‹ç¯‰ã€‚

---

## å®Ÿè£…ã™ã‚‹API

### ãƒªãƒ¼ã‚°ç®¡ç†ï¼ˆ6ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆï¼‰
- `POST /api/leagues` - ãƒªãƒ¼ã‚°ä½œæˆ
- `GET /api/leagues` - ãƒªãƒ¼ã‚°ä¸€è¦§
- `GET /api/leagues/:id` - ãƒªãƒ¼ã‚°è©³ç´°
- `PATCH /api/leagues/:id` - ãƒªãƒ¼ã‚°æ›´æ–°
- `DELETE /api/leagues/:id` - ãƒªãƒ¼ã‚°å‰Šé™¤ï¼ˆè«–ç†å‰Šé™¤ï¼‰
- `PATCH /api/leagues/:id/status` - ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å¤‰æ›´

### ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ç®¡ç†ï¼ˆ2ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆï¼‰
- `PATCH /api/leagues/:id/players/:playerId` - ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼åæ›´æ–°
- `PATCH /api/leagues/:id/players/:playerId/role` - æ¨©é™å¤‰æ›´

---

## å®Ÿè£…ã®æµã‚Œ

### ã‚¹ãƒ†ãƒƒãƒ—1: åŸºç›¤æº–å‚™
1. ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆä½œæˆï¼ˆ`src/server/`, `src/client/`ï¼‰
2. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šè¨­å®šï¼ˆ`db/index.ts`ï¼‰
3. èªè¨¼ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ä½œæˆï¼ˆ`src/server/middleware/auth.ts`ï¼‰
4. ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒ©ãƒ¼ä½œæˆï¼ˆ`src/server/middleware/error-handler.ts`ï¼‰

### ã‚¹ãƒ†ãƒƒãƒ—2: ãƒªãƒ¼ã‚°ä½œæˆAPIï¼ˆæœ€é‡è¦ï¼‰
1. ãƒãƒªãƒ‡ãƒ¼ã‚¿ä½œæˆï¼ˆ`src/server/validators/leagues.validator.ts`ï¼‰
2. ãƒªãƒã‚¸ãƒˆãƒªä½œæˆï¼ˆ`src/server/repositories/leagues.repository.ts`ï¼‰
3. ã‚µãƒ¼ãƒ“ã‚¹ä½œæˆï¼ˆ`src/server/services/leagues.service.ts`ï¼‰
4. ãƒ«ãƒ¼ãƒˆä½œæˆï¼ˆ`src/server/routes/leagues.ts`ï¼‰
5. AppTypeã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆï¼ˆ`src/server/routes/index.ts`ï¼‰

### ã‚¹ãƒ†ãƒƒãƒ—3: æ®‹ã‚Šã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
6. ãƒªãƒ¼ã‚°ä¸€è¦§ã€è©³ç´°ã€æ›´æ–°ã€å‰Šé™¤ã€ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å¤‰æ›´
7. ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼åæ›´æ–°ã€æ¨©é™å¤‰æ›´

### ã‚¹ãƒ†ãƒƒãƒ—4: ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰çµ±åˆ
8. RPCã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆåˆæœŸåŒ–ï¼ˆ`src/client/api.ts`ï¼‰
9. React Query Hooksä½œæˆï¼ˆ`src/client/hooks/useLeagues.ts`ï¼‰

---

## é‡è¦ãªå®Ÿè£…ãƒã‚¤ãƒ³ãƒˆ

### ãƒªãƒ¼ã‚°ä½œæˆæ™‚ã®å‡¦ç†
1. **ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³å‡¦ç†**
   - ãƒªãƒ¼ã‚°ä½œæˆ + ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ä½œæˆã‚’1ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã§å®Ÿè¡Œ

2. **ä½œæˆè€…ã®æ¨©é™ä»˜ä¸**
   - æœ€åˆã®ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ï¼ˆindex: 0ï¼‰ã‚’ä½œæˆè€…ã¨ç´ã¥ã‘
   - è‡ªå‹•çš„ã« `role: admin` ã‚’è¨­å®š

3. **ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼æ•°æ¤œè¨¼**
   - 8äººã¾ãŸã¯16äººã®ã¿è¨±å¯

### æ¨©é™ãƒã‚§ãƒƒã‚¯
- adminæ¨©é™ãŒå¿…è¦ãªæ“ä½œï¼šãƒªãƒ¼ã‚°æ›´æ–°ã€å‰Šé™¤ã€ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å¤‰æ›´ã€ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ç®¡ç†
- Serviceå±¤ã§ `hasAdminRole()` ã‚’å®Ÿè£…

---

## æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

- Hono v4.10.4
- Zod + @hono/zod-validator
- Drizzle ORM v0.44.7
- Supabase Auth
- React Query

---

## å‚è€ƒè³‡æ–™

- [api-design.md](../api-design.md)
- [directory-structure.md](../directory-structure.md)
- [Hono RPC](https://hono.dev/guides/rpc)

---

**ä½œæˆæ—¥:** 2025-11-09
